<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Thanh To√°n ƒê∆°n H√†ng</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
	rel="stylesheet" />
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<link th:href="@{/assets/css/web/order_payment.css}" rel="stylesheet" />

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
<div th:insert="~{web/fragments/header :: headerShop}"></div>
	<div class="container">
		<div class="mb-4">
			<div class="section-title">üó∫ V·ªã tr√≠ giao h√†ng</div>
			<div id="map" style="height: 350px; border: 1px solid #ccc; border-radius: 6px;"></div>
		</div>
		<div class="checkout-container">
			<form method="POST" th:action="@{/order}" id="formOrder">
				<!-- 1. Th√¥ng tin ng∆∞·ªùi nh·∫≠n -->
				<div class="mb-4">
					<div class="section-title">üìç Th√¥ng tin nh·∫≠n h√†ng</div>
					<div class="row g-3">
						<div class="col-md-6">
							<label for="fullName" class="form-label">H·ªç t√™n</label> <input
								type="text" class="form-control" id="recipientName" name="recipientName"
								required />
						</div>
						<div class="col-md-6">
							<label for="phone" class="form-label">S·ªë ƒëi·ªán tho·∫°i</label> <input
								type="tel" class="form-control" id="recipientPhone" name="recipientPhone" required />
						</div>
						<div class="col-12">
							<label for="address" class="form-label">ƒê·ªãa ch·ªâ nh·∫≠n h√†ng</label>
							<textarea class="form-control" id="address" name="address"
								rows="2" required></textarea>
						</div>
					</div>
				</div>

				<!-- 2. Danh s√°ch s·∫£n ph·∫©m -->
				<div class="mb-4">
					<div class="section-title">üì¶ S·∫£n ph·∫©m</div>
					<div class="table-responsive" >
						<table class="table align-middle">
							<thead>
								<tr>
									<th>S·∫£n ph·∫©m</th>
									<th>ƒê∆°n gi√°</th>
									<th>S·ªë l∆∞·ª£ng</th>
									<th>Th√†nh ti·ªÅn</th>
								</tr>
							</thead>
							<tbody th:each="item : ${product}">
								<tr>
									<td>
										<div class="d-flex align-items-center">
											<img th:src="@{'/images/' + ${item.getProductEntity().getImageUrl()}}" class="product-img me-2" />
											<div>
												<div></div>
												<div class="text-muted small"></div>
											</div>
										</div>
									</td>
									<td class="text-danger" th:text="${item.getProductEntity().getPrice() + 'ƒë'}"></td>
									<td th:text="${item.getQuantity()}"></td>
									<td th:text="${item.getPriceTotal()}"></td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>

				<!-- 3. Ph∆∞∆°ng th·ª©c thanh to√°n -->
				<div class="container mt-4">
					<h4>Ph∆∞∆°ng th·ª©c thanh to√°n</h4>
					<form>
						<!-- Ch·ªçn lo·∫°i thanh to√°n -->
						<div class="form-check">
							<input class="form-check-input" type="radio" name="paymentMethod"
								id="paymentCod" value="cod" checked> <label
								class="form-check-label" for="paymentCod"> Thanh to√°n
								khi nh·∫≠n h√†ng (COD) </label>
						</div>

						<div class="form-check">
							<input class="form-check-input" type="radio" name="paymentMethod"
								id="paymentOnline" value="online"> <label
								class="form-check-label" for="paymentOnline"> Thanh to√°n
								online </label>
						</div>

						<!-- N·∫øu ch·ªçn Online th√¨ hi·ªán th√™m c√°c ph∆∞∆°ng th·ª©c con -->
						<div id="onlineOptions" class="mt-3" style="display: none;">
							<h5>Ph∆∞∆°ng th·ª©c online</h5>
							<div class="form-check ms-3">
								<input class="form-check-input" type="radio" name="onlineOption"
									id="qrCode" value="qr"> <label class="form-check-label"
									for="qrCode"> Thanh to√°n b·∫±ng m√£ QR </label>
							</div>
							<div class="form-check ms-3">
								<input class="form-check-input" type="radio" name="onlineOption"
									id="vnpay" value="vnpay"> <label
									class="form-check-label" for="vnpay"> VNPAY </label>
							</div>
						</div>
					</form>
				</div>

				<!-- 4. T·ªïng ti·ªÅn v√† ƒê·∫∑t h√†ng -->
				<div class="row align-items-center">
					<div class="col-md-6">
						<span class="fs-6">Ph√≠ v·∫≠n chuy·ªÉn: </span><span class="fw-bold">20,000
							ƒë</span><br /> <span class="fs-5">T·ªïng thanh to√°n: </span> <span
							class="total-price"></span>
					</div>
					<div class="col-md-6 text-end">
						<button class="btn btn-order" type="submit">üõç ƒê·∫∑t h√†ng</button>
					</div>
				</div>
			</form>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	
	<script>
		const map = L.map('map').setView([ 21.0285, 105.8542 ], 13); // v√≠ d·ª•: H√† N·ªôi

		L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
			attribution : '&copy; OpenStreetMap contributors'
		}).addTo(map);

		L.marker([ 21.0285, 105.8542 ]).addTo(map).bindPopup(
				'V·ªã tr√≠ giao h√†ng m·∫∑c ƒë·ªãnh').openPopup();
		
		$(document).ready(function () {
	        $('input[name="paymentMethod"]').change(function () {
	            if ($('#paymentOnline').is(':checked')) {
	                $('#onlineOptions').slideDown();
	            } else {
	                $('#onlineOptions').slideUp();
	                $('input[name="onlineOption"]').prop('checked', false);
	            }
	        });
	    });
	</script>
</body>
</html>
